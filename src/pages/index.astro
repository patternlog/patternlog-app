---
import { getCollection } from "astro:content";
import type { Pattern } from "../content/config";

import Layout from "./_layout.astro";
import PatternCard from "../components/PatternCard";
import FilterBar from "../components/FilterBar";
import SearchInput from "../components/SearchInput";

const patterns = await getCollection("patterns");

let search = Astro.url.searchParams.get("q") || "";
let filtered = patterns.filter((p: Pattern) => p.data.title.toLowerCase().includes(search.toLowerCase()));
---

<Layout>
  <SearchInput />
  <FilterBar />
  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 mt-6">
    {filtered.map((p: Pattern) => <PatternCard pattern={p} />)}
  </div>
</Layout>
